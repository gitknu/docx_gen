<html>
    <body>
        <h3>Номер договору</h3>
        <input type="text" id="arg_num_input" placeholder="Номер договору">
        <h3>Строк договору</h3>
        <select id="dday_start">
            <option value="___">дд</option>
            <script>
                for (let i = 1; i <= 31; i++) {
                    document.write(`<option value="${i}">${i}</option>`);
                }
            </script>
        </select>
        <select id="ddmon_start">
            <option value="____________">мм</option>
            <option value="січня">січня</option>
            <option value="лютого">лютого</option>
            <option value="березня">березня</option>
            <option value="квітня">квітня</option>
            <option value="травня">травня</option>
            <option value="червня">червня</option>
            <option value="липня">липня</option>
            <option value="серпня">серпня</option>
            <option value="вересня">вересня</option>
            <option value="жовтня">жовтня</option>
            <option value="листопада">листопада</option>
            <option value="грудня">грудня</option>
        </select><span> 2024</span>
        <br><br>
        <select id="dday_end">
            <script>
                for (let i = 1; i <= 31; i++) {
                    document.write(`<option value="${i}">${i}</option>`);
                }
            </script>
        </select>
        <select id="ddmon_end">
            <option value="січня">січня</option>
            <option value="лютого">лютого</option>
            <option value="березня">березня</option>
            <option value="квітня">квітня</option>
            <option value="травня">травня</option>
            <option value="червня">червня</option>
            <option value="липня">липня</option>
            <option value="серпня">серпня</option>
            <option value="вересня">вересня</option>
            <option value="жовтня">жовтня</option>
            <option value="листопада">листопада</option>
            <option value="грудня">грудня</option>
        </select>
        <span> 20</span>
        <input type="text" id="ddyr_end" placeholder="Рік">
        <br><br>
        <button onclick="generate()">Generate</button>
    </body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docxtemplater/3.45.0/docxtemplater.js"></script>
    <script src="https://unpkg.com/pizzip@3.1.6/dist/pizzip.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.js"></script>
    <script src="https://unpkg.com/pizzip@3.1.6/dist/pizzip-utils.js"></script>
    <script>
        function loadFile(url, callback) {
            PizZipUtils.getBinaryContent(url, callback);
        }
        window.generate = function generate() {
            const arg_num = document.getElementById("arg_num_input").value;
            const dday_start = document.getElementById("dday_start").value;
            const ddmon_start = document.getElementById("ddmon_start").value;
            const dday_end = document.getElementById("dday_end").value;
            const ddmon_end = document.getElementById("ddmon_end").value;
            const ddyr_end = document.getElementById("ddyr_end").value;
              
if (isNaN(arg_num) && arg_num !== "") {
    alert("Номер договору повинен бути числом!");
    return;
}

if (isNaN(parseInt(ddyr_end)) || ddyr_end < 24 || ddyr_end > 99) {
    alert("Зазначте актуальний рік - між (20)24 і 20(99)!");
    return;
}

            
            loadFile(
                "https://gitknu.github.io/docx_gen/input.docx",
                function (error, content) {
                    if (error) {
                        throw error;
                    }
                    const zip = new PizZip(content);
                    const doc = new window.docxtemplater(zip, {
                        paragraphLoop: true,
                        linebreaks: true,
                    });
                    doc.render({
                        agr_num: arg_num,
                        dday_start: dday_start,
                        ddmon_start: ddmon_start,
                        dday_end: dday_end,
                        ddmon_end:  ddmon_end,
                        ddyr_end: ddyr_end,
                        client_company: "Компанія ''Шевченко і партнери''",
                        client_position_rid: "директора",
                        client_person_rid: "Тараса ШЕВЧЕНКА",
                        client_position: "Директор",
                        client_person: "Тарас ШЕВЧЕНКО",
                        doc_reason: "договору про нерозголошення",
                        services_list: "зважити пісок, пересипати сніг",
                        val_num_large: "123,000",
                        val_num_small: "123",
                        fee_num_large: "23,000",
                        fee_num_small: "23",
                        postal_code: "12345",
                        city_name: "м. Харків",
                        street_else: "вул. Петра Петриченка, 1",
                        tax_num: "123456789",
                        bank_info: "123456789",
                        unified_code: "1234567",
                        name_advisor: "Леся УКРАЇНКА",
                        mobile_num: "0660000000",
                    });
                    const blob = doc.getZip().generate({
                        type: "blob",
                        mimeType:
                            "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
                        compression: "DEFLATE",
                    });
                    saveAs(blob, "Договір.docx");
                }
            );
        };
    </script>
</html>
